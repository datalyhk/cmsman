{% load crispy_forms_tags %}
<div class="modal-header">
    <h3 class="modal-title">New Expense Entry</h3>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>

<div class="modal-body">
    {% if delivery_obj.bill %}
    <table class="table table-hover table-sm table-striped">
        <thead>
          <tr>
            <th scope="col">Invoice</th>
            <th scope="col">Paid Date</th>
            <th scope="col">Payee</th>
            <th scope="col">Category</th>
            <th scope="col">Amount</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ delivery_obj.bill.invoice_date|date:"d-m-y" }}</td>
            <td>{{ delivery_obj.bill.expected_date|date:"d-m-y" }}</td>
            <td>{{ delivery_obj.bill.payee }}</td>
            <td>{{ delivery_obj.bill.category.name }}</td>
            <td class="text-monospace text-right">{{ delivery_obj.bill.amount }}</td>
            <td>
              <a
                href="{% url 'ledger:ExpenseUpdate' delivery_obj.bill.pk %}"
                class="btn-expense_update btn btn-sm btn-primary"
              >
                <i class="fad fa-file-alt"></i>
              </button>
              {% if delivery_obj.bill.category.name == "Drugs" %}
              <a
                href="{% url 'drugdb:BillDrugDeliveryView' delivery_obj.bill.pk %}"
                class="btn btn-sm btn-info"
              >
                <i class="fad fa-layer-plus"></i>
              </a>
              {% endif %}
            </td>
          </tr>
        </tbody>
      </table>
    {% else %}
    {% crispy form %}
    {{form.media}}
    {% endif %}
</div>

<div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
</div>

{% block extrascripts %}
{{ form.media }}

<script type="text/javascript">
    $(document).ready(function () {
        $("#add_vendor_button").modalForm({
            formURL: "{% url 'inventory:NewVendorModal' %}"
        });
        $("#id_vendor").change(function() {
            $("#id_payee").val($("#id_vendor option:selected").text());
        });
    })
</script>
{% endblock %}
