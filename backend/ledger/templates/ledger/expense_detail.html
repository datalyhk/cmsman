{% extends 'base.html' %}

{% block title %}
  Expense Record: {{ expense_obj.entry_date }}
{% endblock %}

{% block content %}
  {% include '_modal.html' %}

  <div class="card shadow">
    <div class="card-header text-white bg-info">
      <div class="d-flex justify-content-between align-items-center">
        <span>
          <i class="fad fa-table" aria-hidden="true"></i>
          Expense on {{ expense_obj.entry_date }}
        </span>
        <span>
          <a
            href="{% url 'ledger:ExpenseList' %}"
            class="btn btn-sm btn-dark text-white"
          ><i class="fal fa-step-backward"></i>&nbsp;Expenses
          </a>
          <a
            href="{% url 'inventory:DeliveryOrderList' %}"
            class="btn btn-sm btn-dark text-white"
          ><i class="fal fa-step-backward"></i>&nbsp;Orders
          </a>
          <a
            href="{% url 'inventory:DeliveryItemList' %}"
            class="btn btn-sm btn-dark text-white"
          ><i class="fal fa-step-backward"></i>&nbsp;Drugs
          </a>
          <button
            class="btn_modal_trigger btn btn-sm btn-light"
            data-id="{% url 'ledger:ExpenseUpdateModal' expense_obj.id %}"
          >Edit
          </button>
        </span>
      </div>
    </div>
    <div class="card-body">
      <div class="form-row">
        <div class="col-md-7 mb-0"><strong>{{ expense_obj.payee }}</strong>
          <span type="button"
            class="btn_modal_trigger badge badge-secondary ml-2 mt-0"
            data-id="{% url 'inventory:NewDeliveryOrderModal' %}?vendor={{ expense_obj.vendor.id }}"
          >Add new delivery
          </span>
          <hr>
        </div>
        <div class="col-md-2 mb-0">Amount</div>
        <div class="col-md-3 mb-0"><strong>$ {{ expense_obj.amount }}</strong></div>
      </div>
      <div class="form-row">
        <div class="col-md-2 mb-0">Description</div>
        <div class="col-md-5 mb-0">{{ expense_obj.description }}</div>
        <div class="col-md-2 mb-0">Entry Date</div>
        <div class="col-md-3 mb-0">{{ expense_obj.entry_date|date:"d-m-Y" }}</div>
      </div>
      <div class="form-row">
        <div class="col-md-2 mb-0">Category</div>
        <div class="col-md-5 mb-0">{{ expense_obj.category.name }}</div>
        
        <div class="col-md-2 mb-0">Invoice Date</div>
        <div class="col-md-3">{{ expense_obj.invoice_date |date:"d-m-Y"}}</div>
      </div>
      <div class="form-row">
        <div class="col-md-2 mb-0">Invoice No.</div>
        <div class="col-md-5 mb-0">{{ expense_obj.invoice_no }}</div>
        <div class="col-md-2 mb-0">Cheque/Paid Date</div>
        <div class="col-md-3 mb-0">{{ expense_obj.expected_date|date:"d-m-Y"}}</div>
      </div>
      <div class="form-row">
        <div class="col-md-2 mb-0">Cheque No.</div>
        <div class="col-md-5 mb-0">{{ expense_obj.payment_ref }}</div>
        <div class="col-md-2 mb-0">Payment</div>
        <div class="col-md-3 mb-0">{{ expense_obj.payment_method.name }}</div>
      </div>
      <div class="form-row">
        <div class="col-md-2 mb-0">Remarks</div>
        <div class="col-md-5 mb-0">{{ expense_obj.remarks }}</div>
        <div class="col-md-2 mb-0">Other Ref</div>
        <div class="col-md-3 mb-0">{{ expense_obj.other_ref }}</div> 
      </div>
      <hr>
      {% if deliveryorder_list %}
          {% include 'ledger/_deliveryorder_list_table.html' %}
      {% else %}    
          <p>No delivery order in database</p>
      {% endif %}
    </div>
  </div>
  {% include 'ledger/_unpaid_delivery_orders.html' %}
{% endblock %}

{% block extrascripts %}
<script type="text/javascript">
  $(document).ready(function () {
      $(".btn_modal_trigger").each(function() {
          $(this).modalForm({
              formURL: $(this).data('id')
          });
      });
  });
</script>
{% endblock %}