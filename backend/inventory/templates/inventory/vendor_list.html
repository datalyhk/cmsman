{% extends 'base.html' %}

{% block title %} Vendors {% endblock %} 

{% load crispy_forms_tags %}

{% block content %}

{% include "_modal.html" %}

<h1>Vendors</h1>
<nav class="row">
  <div class="col-4">
    <form action="{% url 'inventory:VendorList' %}" method="get">
      <input
        class="form-control"
        name="q"
        type="text"
        placeholder="Search Vendors..."
      />
    </form>
  </div>
  <div class="col-4">
    {% if last_query %} Results for "{{ last_query }}" ({{ last_query_count }})
    {% endif %}
  </div>
  <div class="col-4">
    {% if is_paginated %}

    <ul class="pagination">
      <li class="page-item">
        <a
          href="{% url 'inventory:VendorList' %}?q={{ last_query }}&page=1"
          class="page-link"
        >
          First
        </a>
      </li>
      {% if page_obj.has_previous %}
      <li class="page-item">
        <a
          href="{% url 'inventory:VendorList' %}?q={{ last_query }}&page={{ page_obj.previous_page_number }}"
          class="page-link"
        >
          {{ page_obj.previous_page_number }}
        </a>
      </li>
      {% endif %}
      <li class="page-item active">
        <a
          href="{% url 'inventory:VendorList' %}?q={{ last_query }}&page={{ page_obj.number }}"
          class="page-link"
        >
          {{ page_obj.number }}
        </a>
      </li>
      {% if page_obj.has_next %}
      <li class="page-item">
        <a
          href="{% url 'inventory:VendorList' %}?q={{ last_query }}&page={{ page_obj.next_page_number }}"
          class="page-link"
        >
          {{ page_obj.next_page_number }}
        </a>
      </li>
      {% endif %}
      <li class="page-item">
        <a
          href="{% url 'inventory:VendorList' %}?q={{ last_query }}&page=last"
          class="page-link"
        >
          Last ({{ page_obj.paginator.num_pages }})
        </a>
      </li>
    </ul>
    {% endif %}
  </div>
</nav>

<button id="btn_add_vendor" class="btn btn-sm btn-primary">New Vendor</button>

{% if vendor_list %}
<table class="table table-sm table-striped">
  <thead>
    <tr>
      <th scope="col">Vendor</th>
      <th scope="col">Alias</th>
      <th scope="col">Category</th>
      <th scope="col">Contact</th>
      <th scope="col">Tel</th>
      <th scope="col">Email</th>
      <th scope="col">Action</th>
    </tr>
  </thead>
  <tbody>
    {% for vendor in vendor_list %}

    <tr>
      <td>{{ vendor.name }}</td>
      <td>{{ vendor.alias }}</td>
      <td>{{ vendor.default_exp_category }}</td>
      <td>{{ vendor.contact_person }}</td>
      <td>{{ vendor.tel_main }}</td>
      <td>{{ vendor.email }}</td>
      <td>
        <button
          type="button"
          class="btn_vendor_update btn btn-sm btn-primary"
          data-id="{% url 'inventory:VendorUpdateModal' vendor.pk %}"
        >
          <i class="fad fa-file-alt"></i>
        </button>
        <a
          href="{% url 'inventory:NewItem' vendor.id %}"
          class="btn btn-sm btn-primary"
        >
          <i class="fad fa-cart-plus"></i>
        </a>
        <a
          href="{% url 'inventory:VendorDelete' vendor.id %}"
          class="btn btn-sm btn-danger"
        >
          <i class="fad fa-trash-alt"></i>
        </a>
      </td>
    </tr>

    {% endfor %}
  </tbody>
</table>

{% else %}

<p>No vendors in database</p>

{% endif %}

{% endblock %} 

{% block extrascripts %}

<script type="text/javascript">
  $(document).ready(function () {
   $("#btn_add_vendor").modalForm({
       formURL: "{% url 'inventory:NewVendorModal' %}"
   });
   $(".btn_vendor_update").each(function() {
       $(this).modalForm({
           formURL: $(this).data('id')
       });
   });
  });
</script>

{% endblock %}